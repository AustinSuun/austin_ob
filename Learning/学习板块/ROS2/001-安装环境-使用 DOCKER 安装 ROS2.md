---
æ—¥æœŸ: 2025-04-25
ä½œè€…: 
tags:
  - DOCKER
  - ROS2
  - æ‰§è¡Œæƒé™
---
## ğŸ³ Docker æ˜¯ä¸ªå•¥ï¼Ÿ

Docker å°±åƒä¸ªâ€œ**è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨**â€ï¼Œæ¯ä¸ªâ€œå®¹å™¨â€å°±æ˜¯ä¸€ä¸ªå¯ä»¥è¿è¡Œçš„è¿·ä½ ç³»ç»Ÿï¼Œé‡Œè¾¹å¯ä»¥è£… ROSã€Pythonã€ç½‘é¡µæœåŠ¡å™¨ï¼Œå•¥éƒ½è¡Œã€‚ä½ å¯ä»¥éšæ—¶å¯åŠ¨ã€åœæ­¢ã€åˆ æ‰ï¼Œå’Œä½ çš„ä¸»ç³»ç»Ÿå®Œå…¨åˆ†å¼€ã€‚

---

## âœ… ç¬¬ä¸€æ­¥ï¼šå®‰è£… Dockerï¼ˆArchï¼‰

æ‰“å¼€ç»ˆç«¯ï¼Œè¾“ï¼š

```bash
sudo pacman -S docker
sudo systemctl enable --now docker
sudo usermod -aG docker $USER
```

ç„¶å **é€€å‡ºé‡æ–°ç™»å½•** æˆ–è€…ç›´æ¥é‡å¯ï¼ˆè®© docker æƒé™ç”Ÿæ•ˆï¼‰ã€‚

ps:å¦‚æœå®‰è£…æ—¶å¤±è´¥ï¼Œå¯ä»¥æ›´æ–°ä¸€ä¸‹è½¯ä»¶ä»“åº“ `sudo pacman -Syy`

ï¼ˆ**å¯é€‰ï¼‰å®‰è£… lazydocker-ç»ˆç«¯å¯è§†åŒ–å·¥å…·**

```jsx
yay â€”S lazydocke
```

---

## âœ… ç¬¬äºŒæ­¥ï¼šæ‹‰ ROS 2 Jazzy é•œåƒ

jazzy æ˜¯æœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬

é•œåƒæ¥æºï¼Œä½¿ç”¨æŒ‡å®šçš„ tag æ‹‰å–ï¼Œä¸‹è½½ jazzy-fullï¼Œæœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆçš„å®Œæ•´åŒ…

[https://hub.docker.com/r/althack/ros2/tags?name=ja](https://hub.docker.com/r/althack/ros2/tags?name=ja)

```bash
docker pull althack/ros2:jazzy-full-2025-04-01
```

è¿™ä¸ªé•œåƒå°±æ˜¯ï¼š**å®˜æ–¹å‘å¸ƒçš„ ROS 2 Jazzy ç¯å¢ƒ**ï¼Œå¹²å‡€ç¨³å®šï¼Œé€‚åˆå¼€å‘ã€‚

psï¼šæ‹‰å–é•œåƒè¶…æ—¶ï¼Œæ‰“å¼€ ä»£ç† tun æ¨¡å¼ å†æ‹‰å–

ä¸‹è½½å®Œ è¿è¡Œ `docker images` æŸ¥çœ‹é•œåƒ

---

## âœ… ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œ ROS 2 å®¹å™¨

ç°åœ¨æ¥è·‘ä¸€ä¸ªæœ€åŸºæœ¬çš„å®¹å™¨ï¼š

```bash
docker run -it --rm ros2:jazzy-full-2025-04-01

```

ä½ ä¼šçœ‹åˆ°è¿›äº†ä¸€ä¸ªç»ˆç«¯ï¼Œæç¤ºç¬¦æ˜¯ `root@xxxxx`ï¼Œç„¶åä½ å¯ä»¥è¯•è¯•ï¼š

```bash
ros2 --help

```

è¯´æ˜ä½ å·²ç»åœ¨å®¹å™¨é‡Œè·‘ ROS 2 äº†ï¼

---

## âœ… ç¬¬å››æ­¥ï¼šæŒ‚è½½ä½ è‡ªå·±çš„ä»£ç ï¼ˆæ›´å®ç”¨ï¼‰

å‡è®¾ä½ æœ‰ä¸ª ROS 2 é¡¹ç›®åœ¨æœ¬åœ° `/home/zhengma/dev_ws`ï¼Œä½ å¯ä»¥è¿™æ ·æŒ‚è¿›å»ï¼š

```bash
docker run -it --rm \\
  -v /home/zhengma/dev_ws:/root/dev_ws \\
  ros2:jazzy-full-2025-04-01
```

å®¹å™¨å†…å°±èƒ½çœ‹åˆ° `/root/dev_ws`ï¼Œç­‰äºæŠŠä½ çš„é¡¹ç›®æ–‡ä»¶æŒ‚è¿›å»äº†ã€‚

---

## âœ… ç¬¬äº”æ­¥ï¼šé€€å‡ºå®¹å™¨

åªè¦æ•²ï¼š

```bash
exit
```

å®¹å™¨å°±å…³äº†ï¼ˆå› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯ `--rm`ï¼Œè‡ªåŠ¨æ¸…ç†ï¼‰ï¼Œä¸€ç‚¹ä¸å èµ„æºã€‚

---

## ğŸ§™ å°é­”æ³•ï¼ˆå¯é€‰ï¼‰

åŠ ä¸€ä¸ªå¿«æ·å‘½ä»¤ï¼Œä»¥åç”¨ï¼š

```bash
alias ros2jazzy='docker run -it --rm ros:jazzy-ros-base'
```

ç„¶åä½ åªè¦æ•²ï¼š

```bash
ros2jazzy
```

å°±èƒ½ç›´æ¥è¿›å…¥ç¯å¢ƒï¼

---

# Docker æ˜¾ç¤ºGUIç•Œé¢é…ç½®

éœ€è¦ä½¿ç”¨ xhost æ¥æ˜¾ç¤ºåˆ°å±å¹•ä¸Š

åœ¨ Arch Linux ä¸Šå®‰è£… `xhost` éå¸¸ç®€å•ï¼Œå®ƒæ˜¯ `xorg-xhost` è½¯ä»¶åŒ…çš„ä¸€éƒ¨åˆ†ã€‚

---

### âœ… å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
sudo pacman -S xorg-xhost
```

---

### ç„¶åæˆæƒ Docker ä½¿ç”¨ X11ï¼š

```bash
xhost +si:localuser:root
```

> è¿™æ¡å‘½ä»¤å‘Šè¯‰ X11ï¼šâ€œå…è®¸æœ¬åœ°çš„ root ç”¨æˆ·ï¼ˆæ¯”å¦‚ä½ çš„ Docker å®¹å™¨ï¼‰è®¿é—®å›¾å½¢ç•Œé¢â€ã€‚

---

### ğŸ¢ æ¥ä¸‹æ¥å°±å¯ä»¥è¿è¡Œ Docker GUI äº†ï¼Œä¾‹å¦‚ï¼š

```bash
docker run -it \\
  --env DISPLAY=$DISPLAY \\
  --env QT_X11_NO_MITSHM=1 \\
  --env QT_QPA_PLATFORM=xcb \\
  --volume /tmp/.X11-unix:/tmp/.X11-unix \\
  ros:humble
```

ç„¶ååœ¨å®¹å™¨é‡Œè¿è¡Œï¼š

```bash
ros2 run turtlesim turtlesim_node
```

---

ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸€é”®è„šæœ¬ï¼Œåå« `run_turtlesim.sh`ï¼Œé€‚ç”¨äºä½ å½“å‰çš„ Arch Linux + Wayland + Docker ç¯å¢ƒï¼Œè‡ªåŠ¨è®¾ç½®å¥½å›¾å½¢æ˜¾ç¤ºå¹¶å¯åŠ¨å°ä¹Œé¾Ÿï¼š

---

## ğŸ¢ `run_turtlesim.sh` è„šæœ¬å†…å®¹ï¼š

```bash
#!/bin/bash

# ğŸ§ è®¾ç½®å›¾å½¢æ˜¾ç¤ºæƒé™ï¼ˆåªéœ€æ‰§è¡Œä¸€æ¬¡ï¼Œä½†é‡å¤æ‰§è¡Œä¹Ÿæ²¡é—®é¢˜ï¼‰
echo "ğŸ“¢ æˆæƒ root ç”¨æˆ·è®¿é—® X11..."
xhost +si:localuser:root

# ğŸ³ å¯åŠ¨ ROS 2 å®¹å™¨ï¼ˆä½¿ç”¨è½¯ä»¶æ¸²æŸ“ï¼‰
echo "ğŸš€ å¯åŠ¨ ROS 2 turtlesim å®¹å™¨..."

docker run -it --rm \\
  --env DISPLAY=$DISPLAY \\
  --env LIBGL_ALWAYS_SOFTWARE=1 \\
  --env QT_X11_NO_MITSHM=1 \\
  --env QT_QPA_PLATFORM=xcb \\
  --volume /tmp/.X11-unix:/tmp/.X11-unix \\
  althack/ros2:jazzy-full-2025-04-01 \\
  bash -c "ros2 run turtlesim turtlesim_node"
```

---

## âœ… ä½¿ç”¨æ–¹æ³•ï¼š

1. **ä¿å­˜ä¸ºè„šæœ¬æ–‡ä»¶**ï¼ˆæ¯”å¦‚ `run_turtlesim.sh`ï¼‰ï¼š
    
    ```bash
    nano run_turtlesim.sh
    # ç²˜è´´è„šæœ¬å†…å®¹ï¼Œç„¶å Ctrl+O ä¿å­˜ï¼ŒCtrl+X é€€å‡º
    
    ```
    
2. **åŠ æ‰§è¡Œæƒé™**ï¼š
    
 ```bash
	chmod +x run_turtlesim.sh
  
  ```

3. **è¿è¡Œï¼**
 
```bash
	./run_turtlesim.sh
```


---

è¿™è„šæœ¬ä¼šè‡ªåŠ¨ï¼š

- æˆæƒå®¹å™¨è®¿é—®å›¾å½¢ç•Œé¢
- å¯åŠ¨ ROS 2 å®¹å™¨
- ä½¿ç”¨è½¯ä»¶æ¸²æŸ“è§£å†³ OpenGL é—®é¢˜
- å¯åŠ¨å°ä¹Œé¾ŸèŠ‚ç‚¹æ˜¾ç¤ºçª—å£

---

å¦‚æœä½ åç»­æƒ³æ”¯æŒ `teleop` æˆ–ç”¨ `rviz2`ã€`rqt`ï¼Œæˆ‘ä¹Ÿå¯ä»¥å¸®ä½ æ‰©å±•è¿›å»ï¼

# å¼€å¤šç»ˆç«¯çš„æ–¹æ³•

ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„å®¹å™¨åå­—å«åš `my_container`ï¼Œé‚£ä¹ˆå‘½ä»¤ä¼šæ˜¯è¿™æ ·çš„ï¼š

```bash
docker exec -it my_container bash
```

è¿™å°†åœ¨ `my_container` å®¹å™¨ä¸­æ‰“å¼€ä¸€ä¸ªæ–°çš„ bash ç»ˆç«¯ï¼Œå…è®¸ä½ åœ¨å…¶ä¸­æ‰§è¡Œå‘½ä»¤å’Œæ“ä½œã€‚